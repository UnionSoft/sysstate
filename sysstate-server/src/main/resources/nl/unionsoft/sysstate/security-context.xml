<?xml version="1.0" encoding="UTF-8"?>
<beans:beans xmlns="http://www.springframework.org/schema/security" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:beans="http://www.springframework.org/schema/beans"
	xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.1.xsd
		http://www.springframework.org/schema/security http://www.springframework.org/schema/security/spring-security-4.0.xsd">


<!-- 
admin   	//Manage everything
manager 	//Manage most aspects of the site
editor  	//Scheduling and managing content
author  	//Write important content
contributors//Authors with limited rights
moderator   	//Moderate user content
member  	//Special user access
subscriber  	//Paying Average Joe
user    	//Average Joe

 -->

	<http auto-config="true" >
	
		<intercept-url pattern="/environment/**" access="ROLE_EDITOR,ROLE_ADMIN" />
		
		<intercept-url pattern="/text/**" access="ROLE_DEVELOPER" />
		
		<intercept-url pattern="/project/**" access="ROLE_EDITOR,ROLE_ADMIN" />
		<intercept-url pattern="/script/**" access="ROLE_ADMIN" />
        
        <intercept-url pattern="/configuration/**" access="ROLE_ADMIN" />        
		
		<intercept-url pattern="/instance/*/configuration*" access="ROLE_EDITOR,ROLE_ADMIN" />
		<intercept-url pattern="/instance/*/update*" access="ROLE_EDITOR,ROLE_ADMIN" />
		<intercept-url pattern="/instance/*/delete*" access="ROLE_EDITOR,ROLE_ADMIN" />
		<intercept-url pattern="/instance/*/copy*" access="ROLE_EDITOR,ROLE_ADMIN" />		
		<intercept-url pattern="/instance/*/refresh*" access="ROLE_EDITOR,ROLE_ADMIN" />
		<intercept-url pattern="/instance/*/toggle/*" access="ROLE_EDITOR,ROLE_ADMIN" />
		<intercept-url pattern="/instance/*/create*" access="ROLE_EDITOR,ROLE_ADMIN" />
		
		<intercept-url pattern="/view/*/update*" access="ROLE_EDITOR,ROLE_ADMIN" />
		<intercept-url pattern="/view/*/delete*" access="ROLE_EDITOR,ROLE_ADMIN" />
		<intercept-url pattern="/view/create*" access="ROLE_EDITOR,ROLE_ADMIN" />
		
		<intercept-url pattern="/template/*/delete*" access="ROLE_ADMIN" />
		<intercept-url pattern="/template/*/create*" access="ROLE_ADMIN" />
		<intercept-url pattern="/template/*/update*" access="ROLE_ADMIN" />	
        
		<intercept-url pattern="/filter/*/delete*" access="ROLE_EDITOR,ROLE_ADMIN" />
		<intercept-url pattern="/instance/multi/enable*" access="ROLE_EDITOR,ROLE_ADMIN" />
		<intercept-url pattern="/instance/multi/disable*" access="ROLE_EDITOR,ROLE_ADMIN" />
		<intercept-url pattern="/instance/multi/refresh*" access="ROLE_EDITOR,ROLE_ADMIN" />
		<!-- 
		<intercept-url pattern="/discovery/**" access="ROLE_EDITOR,ROLE_ADMIN" />
		 -->
		<intercept-url pattern="/cache/**" access="ROLE_ADMIN" />
		<intercept-url pattern="/property/**" access="ROLE_ADMIN" />
		
		<intercept-url pattern="/user/*" access="ROLE_EDITOR,ROLE_ADMIN" />
		<intercept-url pattern="/user/*/update*" access="ROLE_ADMIN" />
		<intercept-url pattern="/user/*/delete*" access="ROLE_ADMIN" />
		<intercept-url pattern="/user/create*" access="ROLE_ADMIN" />		
		

		<intercept-url pattern="/instancenotifier/**" access="ROLE_ADMIN" />
		<intercept-url pattern="/projectenvironment/**/update" access="ROLE_ADMIN" />
		<!--
			<intercept-url pattern="/scheduler/**" access="ROLE_ADMIN" />
			<intercept-url pattern="/cache/**" access="ROLE_ADMIN" />
		 -->
		<!-- <http-basic /> -->
		<form-login login-page="/login.html" default-target-url="/dashboard/index.html" authentication-failure-url="/login.html" always-use-default-target="false"/>
		<logout logout-success-url="/dashboard/index.html" logout-url="/logout.html" />
		<remember-me key="sseSecurityToken" token-validity-seconds="864000" />
	</http>

	<authentication-manager>
		<authentication-provider>
			<password-encoder hash="md5" />
			<jdbc-user-service data-source-ref="dataSource" users-by-username-query="SELECT login, password, enabled from SSE_USER WHERE login=?"
				authorities-by-username-query="SELECT user.login, userRole.authority FROM SSE_USER user, SSE_USER_ROLE userRole WHERE user.id = userRole.usr_id and user.login=?" />

		</authentication-provider>
	</authentication-manager>

</beans:beans>